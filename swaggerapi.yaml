swagger: "2.0"
info:
  title: KSeF RSA Encryptor API
  description: |
    API do szyfrowania danych RSAES-OAEP (MGF1 + SHA-256) zgodne z wymaganiami KSeF.  
    Umożliwia szyfrowanie kluczy AES lub tokenów za pomocą certyfikatu RSA.
  version: "1.0.3"
  contact:
    name: Grzegorz Szawuła
    url: https://github.com/zvgelo
host: localhost:5000
basePath: /
schemes:
  - http
produces:
  - application/json
consumes:
  - application/json

paths:
  /encrypt:
    post:
      summary: Szyfruje dane wejściowe RSAES-OAEP (MGF1 + SHA-256)
      description: |
        Endpoint szyfrujący dane Base64 za pomocą klucza publicznego z certyfikatu KSeF.  
        W odpowiedzi zwraca zaszyfrowany wynik również w formacie Base64.
      parameters:
        - in: body
          name: body
          required: true
          description: Dane wejściowe do szyfrowania
          schema:
            type: object
            required:
              - data_b64
              - cert_b64
            properties:
              data_b64:
                type: string
                example: "ZGFuZV9pbnB1dA=="
                description: Dane zakodowane Base64 (np. klucz AES lub token|timestamp)
              cert_b64:
                type: string
                example: "MIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8A..."
                description: Certyfikat RSA w formacie PEM lub Base64 DER
              return_b64:
                type: boolean
                example: true
                default: true
                description: Flaga określająca czy wynik ma być zwrócony jako Base64
      responses:
        200:
          description: Dane zostały poprawnie zaszyfrowane
          examples:
            application/json:
              status: "ok"
              encrypted_b64: "MIICIjANBgkqhkiG9w0BAQEFAAOCAQ8A..."
        400:
          description: Błąd walidacji danych wejściowych
          examples:
            application/json:
              status: "error"
              code: 101
              message: "Brak wymaganych pól"
        500:
          description: Błąd wewnętrzny serwera
          examples:
            application/json:
              status: "error"
              code: 199
              message: "Nieoczekiwany błąd: ..."
      tags:
        - RSA Encryptor

  /health:
    get:
      summary: Health-check serwisu
      description: |
        Endpoint do sprawdzania stanu aplikacji.  
        Może być wykorzystywany w monitoringu (np. w Kubernetes).
      responses:
        200:
          description: Serwis działa poprawnie
          examples:
            application/json:
              status: "ok"
              service: "KSeF RSA Encryptor"
      tags:
        - Monitoring
